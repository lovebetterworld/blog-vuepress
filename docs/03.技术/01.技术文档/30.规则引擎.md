---
title: 30.规则引擎
date: 2022-04-19 11:20:00
permalink: /Java/41f8798
categories: 
  - Java
tags: 
  - 
---

## 1 规则引擎概述

### 1.1 什么是规则引擎

**规则引擎**，全称为**业务规则管理系统**，英文名为BRMS(即Business Rule Management System)。规则引擎的主要思想是将应用程序中的业务决策部分分离出来，并使用预定义的语义模块编写业务决策（业务规则），由用户或开发者在需要时进行配置、管理。

需要注意的是规则引擎并不是一个具体的技术框架，而是指的一类系统，即业务规则管理系统。目前市面上具体的规则引擎产品有：drools、VisualRules、iLog等。

规则引擎实现了将业务决策从应用程序代码中分离出来，接收数据输入，解释业务规则，并根据业务规则做出业务决策。规则引擎其实就是一个输入输出平台。

系统中引入规则引擎后，业务规则不再以程序代码的形式驻留在系统中，取而代之的是处理规则的规则引擎，业务规则存储在规则库中，完全独立于程序。业务人员可以像管理数据一样对业务规则进行管理，比如查询、添加、更新、统计、提交业务规则等。业务规则被加载到规则引擎中供应用系统调用。

### 1.2 使用规则引擎的优势

使用规则引擎的优势如下：

1、业务规则与系统代码分离，实现业务规则的集中管理

2、在不重启服务的情况下可随时对业务规则进行扩展和维护

3、可以动态修改业务规则，从而快速响应需求变更

4、规则引擎是相对独立的，只关心业务规则，使得业务分析人员也可以参与编辑、维护系统的业务规则

5、减少了硬编码业务规则的成本和风险

6、使用规则引擎提供的规则编辑工具，使复杂的业务规则实现变得的简单

### 1.3 规则引擎应用场景

对于一些存在比较复杂的业务规则并且业务规则会频繁变动的系统比较适合使用规则引擎，如下：

1、风险控制系统----风险贷款、风险评估

2、反欺诈项目----银行贷款、征信验证

3、决策平台系统----财务计算

4、促销平台系统----满减、打折、加价购

## 2 常见开源规则引擎

### 2.1 Drools

#### 2.1.1 Drools介绍

Drools 是一款由JBoss组织提供的基于Java语言开发的开源规则引擎，可以将复杂且多变的业务规则从硬编码中解放出来，以规则脚本的形式存放在文件或特定的存储介质中(例如存放在数据库中)，使得业务规则的变更不需要修改项目代码、重启服务器就可以在线上环境立即生效。

Drools使用 Rete 算法对所编写的规则求值。Drools  允许使用声明方式表达业务逻辑。

可以使用非 XML 的本地语言编写规则，从而便于学习和理解。并且，还可以将 Java  代码直接嵌入到规则文件中，这令 Drools 的学习更加吸引人。

官网：[http://www.drools.org/#](https://link.jianshu.com?t=http://www.drools.org/#)

官方文档：[http://www.drools.org/learn/documentation.html](https://link.jianshu.com?t=http://www.drools.org/learn/documentation.html)

#### 2.1.2 优点

- 非常活跃的社区支持
- 易用
- 快速的执行速度
- 在 Java 开发人员中流行
- 与 Java Rule Engine API（JSR 94）兼容

### 2.2 EasyRules

#### 2.2.1 概述

Easy Rules是一个简单而强大的Java规则引擎，提供以下功能：

- 轻量级框架和易于学习的API
- 基于POJO的开发与注解的编程模型
- 定义抽象的业务规则并轻松应用它们
- 支持从简单规则创建组合规则的能力
- 支持使用表达式语言（如MVEL和SpEL）定义规则的能力

在一篇非常有趣的规则引擎的[文章](https://link.zhihu.com/?target=http%3A//martinfowler.com/bliki/RulesEngine.html)中，Martin Fowler说：

> 您可以自己构建一个简单的规则引擎。您只需要创建一组具有条件和操作的对象，将它们存储在一个集合中，并运行它们来评估conditions和执行actions。

这正是Easy Rules所做的，它提供了抽象Rule来创建带有conditions和actions的规则，RulesEngine API运行一系列规则来评估conditions和执行actions。

Github地址：https://github.com/j-easy/easy-rules

#### 2.2.2 运行环境

Easy Rules是一个Java库， 需要运行在Java 1.7及以上。

### 2.3 LiteFlow

#### 2.3.1 LiteFlow的特性

- 复杂业务的解耦利器，为所有组件提供统一的实现协议

- 基于规则文件来编排流程，并可进行热编排

- 框架中支持ZooKeeper流程配置，即时推送修改内容

- 能自由扩展配置持久化源，提供扩展接口

- 支持SpringBoot的自动装配，也支持Spring的配置和非Spring的项目

- 提供串行和并行2种模式，提供常见常见的表达式语句

- 提供无级嵌套子流程模式

- 数据槽高并发隔离机制

- 组件的重试机制

- 多种脚本语言的支持

- 自带简单的监控，能够知道每个组件的运行耗时排行

### 2.4 Devs

Devs是一款轻量级的规则引擎。

开源地址：https://github.com/CrankZ/devs

#### 2.4.1 基础概念

此规则引擎的基础概念有字段、条件、规则等。

其中字段组成条件，条件组成规则，并且支持多个条件通过与或组成一个规则。